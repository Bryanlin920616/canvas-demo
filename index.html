<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Canvas Demo</title>
    <style>
        #canvas {
            border: 1px solid #000;
            margin: 20px;
        }
        .toolbar {
            margin: 20px;
        }
    </style>
</head>
<body>
    <div class="toolbar">
        <button onclick="deleteSelected()">刪除選中物件</button>
    </div>
    <canvas id="canvas" width="800" height="600"></canvas>
    <script src="wasm_exec.js"></script>
    <script>
        // 初始化 WebAssembly
        const go = new Go();
        WebAssembly.instantiateStreaming(fetch("main.wasm"), go.importObject)
            .then((result) => {
                go.run(result.instance);
                initCanvas();
            });

        function initCanvas() {
            const canvas = document.getElementById('canvas');
            
            // 滑鼠事件監聽
            canvas.addEventListener('mousedown', (e) => {
                startDrawing(e);
            });
            
            canvas.addEventListener('mousemove', (e) => {
                drawing(e);
            });
            
            canvas.addEventListener('mouseup', (e) => {
                stopDrawing(e);
            });
            
            canvas.addEventListener('mouseleave', (e) => {
                stopDrawing(e);
            });

            // 鍵盤事件監聽
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Delete' || e.key === 'Backspace') {
                    deleteSelected();
                }
            });
        }

        function deleteSelected() {
            if (typeof deleteSelectedShape === 'function') {
                deleteSelectedShape();
            }
        }
    </script>
</body>
</html>
